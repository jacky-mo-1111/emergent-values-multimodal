
Computing utilities for /data/wenjie_jacky_mo/emergent-values/utility_analysis/shared_options/wikiart_style.json...
NCCL version 2.26.2+cuda12.2
Total possible edges: 327645
Training pool: 326645, Holdout: 1000
Resuming from checkpoint: /data/wenjie_jacky_mo/emergent-values/utility_analysis/outputs/internvl3_38b/wikiart_style/checkpoints_internvl3-38b-instruct/ckpt_iter_0005.json
Target total edges: 15652
Initial edges: 810
Number of iterations: 30

Iteration 6/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 23
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6229
Epoch 200, Loss: 0.6118
Epoch 300, Loss: 0.6066
Epoch 400, Loss: 0.6040
Epoch 500, Loss: 0.6025
Epoch 600, Loss: 0.6015
Epoch 700, Loss: 0.6009
Epoch 800, Loss: 0.6004
Epoch 900, Loss: 0.6000
Updated model - Log Loss: 0.5998, Accuracy: 81.39%

Iteration 7/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 31
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6154
Epoch 200, Loss: 0.6017
Epoch 300, Loss: 0.5954
Epoch 400, Loss: 0.5921
Epoch 500, Loss: 0.5902
Epoch 600, Loss: 0.5888
Epoch 700, Loss: 0.5879
Epoch 800, Loss: 0.5872
Epoch 900, Loss: 0.5868
Updated model - Log Loss: 0.5865, Accuracy: 78.42%

Iteration 8/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 28
Epoch 0, Loss: 0.6933
Epoch 100, Loss: 0.6095
Epoch 200, Loss: 0.5953
Epoch 300, Loss: 0.5886
Epoch 400, Loss: 0.5850
Epoch 500, Loss: 0.5826
Epoch 600, Loss: 0.5811
Epoch 700, Loss: 0.5801
Epoch 800, Loss: 0.5794
Epoch 900, Loss: 0.5788
Updated model - Log Loss: 0.5784, Accuracy: 78.52%

Iteration 9/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 29
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6060
Epoch 200, Loss: 0.5918
Epoch 300, Loss: 0.5850
Epoch 400, Loss: 0.5810
Epoch 500, Loss: 0.5787
Epoch 600, Loss: 0.5772
Epoch 700, Loss: 0.5762
Epoch 800, Loss: 0.5755
Epoch 900, Loss: 0.5749
Updated model - Log Loss: 0.5744, Accuracy: 77.68%

Iteration 10/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 29
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6046
Epoch 200, Loss: 0.5896
Epoch 300, Loss: 0.5826
Epoch 400, Loss: 0.5785
Epoch 500, Loss: 0.5763
Epoch 600, Loss: 0.5749
Epoch 700, Loss: 0.5738
Epoch 800, Loss: 0.5729
Epoch 900, Loss: 0.5723
Updated model - Log Loss: 0.5717, Accuracy: 77.95%

Iteration 11/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 22
Epoch 0, Loss: 0.6933
Epoch 100, Loss: 0.6035
Epoch 200, Loss: 0.5879
Epoch 300, Loss: 0.5809
Epoch 400, Loss: 0.5765
Epoch 500, Loss: 0.5738
Epoch 600, Loss: 0.5721
Epoch 700, Loss: 0.5710
Epoch 800, Loss: 0.5701
Epoch 900, Loss: 0.5694
Updated model - Log Loss: 0.5689, Accuracy: 78.48%

Iteration 12/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 23
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6041
Epoch 200, Loss: 0.5887
Epoch 300, Loss: 0.5821
Epoch 400, Loss: 0.5780
Epoch 500, Loss: 0.5750
Epoch 600, Loss: 0.5730
Epoch 700, Loss: 0.5717
Epoch 800, Loss: 0.5707
Epoch 900, Loss: 0.5699
Updated model - Log Loss: 0.5693, Accuracy: 77.86%

Iteration 13/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 47
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6055
Epoch 200, Loss: 0.5899
Epoch 300, Loss: 0.5832
Epoch 400, Loss: 0.5792
Epoch 500, Loss: 0.5764
Epoch 600, Loss: 0.5745
Epoch 700, Loss: 0.5732
Epoch 800, Loss: 0.5721
Epoch 900, Loss: 0.5713
Updated model - Log Loss: 0.5708, Accuracy: 77.25%

Iteration 14/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 27
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6069
Epoch 200, Loss: 0.5910
Epoch 300, Loss: 0.5843
Epoch 400, Loss: 0.5799
Epoch 500, Loss: 0.5769
Epoch 600, Loss: 0.5748
Epoch 700, Loss: 0.5734
Epoch 800, Loss: 0.5724
Epoch 900, Loss: 0.5716
Updated model - Log Loss: 0.5709, Accuracy: 76.52%

Iteration 15/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 25
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6090
Epoch 200, Loss: 0.5932
Epoch 300, Loss: 0.5866
Epoch 400, Loss: 0.5821
Epoch 500, Loss: 0.5792
Epoch 600, Loss: 0.5772
Epoch 700, Loss: 0.5758
Epoch 800, Loss: 0.5748
Epoch 900, Loss: 0.5741
Updated model - Log Loss: 0.5735, Accuracy: 75.70%

Iteration 16/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 18
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6105
Epoch 200, Loss: 0.5947
Epoch 300, Loss: 0.5876
Epoch 400, Loss: 0.5831
Epoch 500, Loss: 0.5804
Epoch 600, Loss: 0.5785
Epoch 700, Loss: 0.5772
Epoch 800, Loss: 0.5762
Epoch 900, Loss: 0.5755
Updated model - Log Loss: 0.5749, Accuracy: 75.75%

Iteration 17/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 22
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6136
Epoch 200, Loss: 0.5982
Epoch 300, Loss: 0.5916
Epoch 400, Loss: 0.5872
Epoch 500, Loss: 0.5845
Epoch 600, Loss: 0.5828
Epoch 700, Loss: 0.5816
Epoch 800, Loss: 0.5807
Epoch 900, Loss: 0.5799
Updated model - Log Loss: 0.5794, Accuracy: 74.78%

Iteration 18/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 37
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6151
Epoch 200, Loss: 0.5997
Epoch 300, Loss: 0.5929
Epoch 400, Loss: 0.5886
Epoch 500, Loss: 0.5858
Epoch 600, Loss: 0.5838
Epoch 700, Loss: 0.5823
Epoch 800, Loss: 0.5812
Epoch 900, Loss: 0.5803
Updated model - Log Loss: 0.5796, Accuracy: 74.13%

Iteration 19/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 30
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6172
Epoch 200, Loss: 0.6021
Epoch 300, Loss: 0.5955
Epoch 400, Loss: 0.5914
Epoch 500, Loss: 0.5888
Epoch 600, Loss: 0.5871
Epoch 700, Loss: 0.5857
Epoch 800, Loss: 0.5846
Epoch 900, Loss: 0.5837
Updated model - Log Loss: 0.5829, Accuracy: 73.57%

Iteration 20/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 35
Epoch 0, Loss: 0.6930
Epoch 100, Loss: 0.6194
Epoch 200, Loss: 0.6045
Epoch 300, Loss: 0.5979
Epoch 400, Loss: 0.5938
Epoch 500, Loss: 0.5912
Epoch 600, Loss: 0.5893
Epoch 700, Loss: 0.5878
Epoch 800, Loss: 0.5867
Epoch 900, Loss: 0.5859
Updated model - Log Loss: 0.5852, Accuracy: 73.46%

Iteration 21/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 36
Epoch 0, Loss: 0.6933
Epoch 100, Loss: 0.6207
Epoch 200, Loss: 0.6058
Epoch 300, Loss: 0.5992
Epoch 400, Loss: 0.5952
Epoch 500, Loss: 0.5929
Epoch 600, Loss: 0.5913
Epoch 700, Loss: 0.5901
Epoch 800, Loss: 0.5892
Epoch 900, Loss: 0.5885
Updated model - Log Loss: 0.5879, Accuracy: 72.59%

Iteration 22/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 19
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6224
Epoch 200, Loss: 0.6074
Epoch 300, Loss: 0.6010
Epoch 400, Loss: 0.5972
Epoch 500, Loss: 0.5948
Epoch 600, Loss: 0.5930
Epoch 700, Loss: 0.5916
Epoch 800, Loss: 0.5906
Epoch 900, Loss: 0.5897
Updated model - Log Loss: 0.5891, Accuracy: 72.48%

Iteration 23/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 26
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6239
Epoch 200, Loss: 0.6090
Epoch 300, Loss: 0.6029
Epoch 400, Loss: 0.5992
Epoch 500, Loss: 0.5966
Epoch 600, Loss: 0.5948
Epoch 700, Loss: 0.5934
Epoch 800, Loss: 0.5924
Epoch 900, Loss: 0.5917
Updated model - Log Loss: 0.5910, Accuracy: 72.03%

Iteration 24/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 28
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6257
Epoch 200, Loss: 0.6110
Epoch 300, Loss: 0.6052
Epoch 400, Loss: 0.6016
Epoch 500, Loss: 0.5992
Epoch 600, Loss: 0.5975
Epoch 700, Loss: 0.5963
Epoch 800, Loss: 0.5953
Epoch 900, Loss: 0.5945
Updated model - Log Loss: 0.5939, Accuracy: 71.57%

Iteration 25/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 38
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6267
Epoch 200, Loss: 0.6120
Epoch 300, Loss: 0.6063
Epoch 400, Loss: 0.6028
Epoch 500, Loss: 0.6006
Epoch 600, Loss: 0.5989
Epoch 700, Loss: 0.5977
Epoch 800, Loss: 0.5968
Epoch 900, Loss: 0.5962
Updated model - Log Loss: 0.5957, Accuracy: 71.59%

Iteration 26/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 37
Epoch 0, Loss: 0.6933
Epoch 100, Loss: 0.6286
Epoch 200, Loss: 0.6145
Epoch 300, Loss: 0.6088
Epoch 400, Loss: 0.6054
Epoch 500, Loss: 0.6030
Epoch 600, Loss: 0.6013
Epoch 700, Loss: 0.6001
Epoch 800, Loss: 0.5992
Epoch 900, Loss: 0.5984
Updated model - Log Loss: 0.5979, Accuracy: 71.27%

Iteration 27/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 20
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6293
Epoch 200, Loss: 0.6151
Epoch 300, Loss: 0.6095
Epoch 400, Loss: 0.6060
Epoch 500, Loss: 0.6037
Epoch 600, Loss: 0.6021
Epoch 700, Loss: 0.6010
Epoch 800, Loss: 0.6002
Epoch 900, Loss: 0.5996
Updated model - Log Loss: 0.5992, Accuracy: 71.00%

Iteration 28/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 24
Epoch 0, Loss: 0.6932
Epoch 100, Loss: 0.6308
Epoch 200, Loss: 0.6168
Epoch 300, Loss: 0.6113
Epoch 400, Loss: 0.6078
Epoch 500, Loss: 0.6053
Epoch 600, Loss: 0.6038
Epoch 700, Loss: 0.6026
Epoch 800, Loss: 0.6017
Epoch 900, Loss: 0.6011
Updated model - Log Loss: 0.6005, Accuracy: 71.11%

Iteration 29/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 25
Epoch 0, Loss: 0.6931
Epoch 100, Loss: 0.6309
Epoch 200, Loss: 0.6169
Epoch 300, Loss: 0.6114
Epoch 400, Loss: 0.6080
Epoch 500, Loss: 0.6058
Epoch 600, Loss: 0.6043
Epoch 700, Loss: 0.6032
Epoch 800, Loss: 0.6023
Epoch 900, Loss: 0.6016
Updated model - Log Loss: 0.6011, Accuracy: 70.83%

Iteration 30/30
Sampling up to 500 new pairs from the intersection of the bottom 10.0% utility differences and bottom 20.0% total degrees.
Number of additional pairs added: 500 (after possibly scaling P and Q)
Number of responses longer than expected: 0
Number of unparseable responses: 34
Epoch 0, Loss: 0.6933
Epoch 100, Loss: 0.6308
Epoch 200, Loss: 0.6164
Epoch 300, Loss: 0.6108
Epoch 400, Loss: 0.6074
Epoch 500, Loss: 0.6052
Epoch 600, Loss: 0.6037
Epoch 700, Loss: 0.6027
Epoch 800, Loss: 0.6019
Epoch 900, Loss: 0.6012
Updated model - Log Loss: 0.6006, Accuracy: 70.52%

Generating pseudolabels using the current Thurstonian model.
Number of pseudolabels added: 40931
Epoch 0, Loss: 0.6936
Epoch 100, Loss: 0.2697
Epoch 200, Loss: 0.2012
Epoch 300, Loss: 0.1875
Epoch 400, Loss: 0.1818
Epoch 500, Loss: 0.1791
Epoch 600, Loss: 0.1771
Epoch 700, Loss: 0.1758
Epoch 800, Loss: 0.1751
Epoch 900, Loss: 0.1743
Final model with pseudolabels - Log Loss: 0.1737, Accuracy: 91.63%
Number of responses longer than expected: 0
Number of unparseable responses: 43

Holdout Set Metrics:
Log Loss: 0.2790
Accuracy: 90.20%
Total time taken: 38404.79394340515 seconds
